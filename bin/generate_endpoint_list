#!/usr/bin/env php
<?php
declare(strict_types=1);

use SimpleLogger\Stdout;

$config = require 'load_config.php';
$logger = new Stdout();

// Build out the endpoint map
(new Firehed\Common\ClassMapGenerator())
    ->setPath(getcwd().DIRECTORY_SEPARATOR.$config['source'])
    ->setInterface('Firehed\API\Interfaces\EndpointInterface')
    ->addCategory('getMethod')
    ->setMethod('getURI')
    ->setNamespace($config['namespace'])
    ->setOutputFile(getcwd().'/__endpoint_list__.json')
    ->generate();

$logger->info(
    'Wrote endpoint map to __endpoint_list__.json. Be sure to commit this ' .
    'file to version control.'
);

// Also do the parser map
(new Firehed\Common\ClassMapGenerator())
    ->setPath(getcwd().'/vendor/firehed/input/src/Parsers')
    ->setInterface('Firehed\Input\Interfaces\ParserInterface')
    ->setMethod('getSupportedMimeTypes')
    ->setNamespace('Firehed\Input\Parsers')
    ->setOutputFile(getcwd().'/__parser_list__.json')
    ->generate();
